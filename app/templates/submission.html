{% extends "logged_in_base.html" %}

{% block title %}Find Restaurants{% endblock %}

{% block content %}
<h1>Find Restaurants Near You</h1>

<div id="locationPrompt">
    <p>This application requires your location to find restaurants in your area.</p>
    <button onclick="getLocation()">Allow Location Access</button>
</div>

<form action="{{ url_for('submission.user_submission') }}" method="POST" id="locationForm" style="display: none;">
    <input type="hidden" name="lat" id="lat">
    <input type="hidden" name="lng" id="lng">
    <p><strong>Maximum Distance (30 miles)</strong></p>
    <input type="number" name="max_distance" placeholder="Enter Distance" max="30" required>
    <p><button type="submit">Find Restaurants</button></p>
</form>

<script>
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            (position) => {
                document.getElementById('lat').value = position.coords.latitude;
                document.getElementById('lng').value = position.coords.longitude;

                document.getElementById('locationPrompt').style.display = 'none';
                document.getElementById('locationForm').style.display = 'block';
            },
            () => {
                alert("Location access denied. Please enable location to use this app.");
            }
        );
    } else {
        alert("Geolocation not supported by your browser");
    }
}
</script>
{% endblock %}