{% extends "logged_in_base.html" %}

{% block title %}Find Restaurants{% endblock %}

{% block content %}
<div class="find-restaurants-container">
    <h1 class="signup-title">Find Restaurants Near You</h1>

    <div class="how-it-works-box">
        <h3 class="how-it-works-title">How It Works</h3>
        <ul class="how-it-works-list">
            <li>We'll show you 10 restaurant suggestions based on your location</li>
            <li>Decide whether you'd "Try" or "Pass" based on the features shown (cuisine, price, distance, etc.)</li>
            <li>Your choices help us learn what you like</li>
            <li>The more you rate, the better your recommendations become</li>
        </ul>
    </div>

    <div id="locationPrompt" class="info-box">
        <p>This application requires your location to find restaurants in your area.</p>
        <button onclick="getLocation()" class="btn-primary">Allow Location Access</button>
    </div>

    <form action="{{ url_for('submission.user_submission') }}" method="POST" id="locationForm" class="signup-form location-form-hidden">
        <input type="hidden" name="lat" id="lat">
        <input type="hidden" name="lng" id="lng">
        
        <p class="form-label"><strong>Maximum Distance (miles):</strong></p>
        <input type="number" name="max_distance" placeholder="Enter distance (up to 30 miles)" max="30" required class="form-input">
        
        <p><button type="submit" class="btn-primary">Find Restaurants</button></p>
    </form>
</div>

<script>
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            (position) => {
                document.getElementById('lat').value = position.coords.latitude;
                document.getElementById('lng').value = position.coords.longitude;

                document.getElementById('locationPrompt').style.display = 'none';
                document.getElementById('locationForm').style.display = 'block';
            },
            () => {
                alert("Location access denied. Please enable location to use this app.");
            }
        );
    } else {
        alert("Geolocation not supported by your browser");
    }
}
</script>
{% endblock %}